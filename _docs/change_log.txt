phpMussel change_log.txt

== CURRENT GOALS AND FUTURE VERSIONING GUIDELINES ==
Next major release (v1.0):
- All planned signature implementations completed, functioning correctly during
  a live test, without any known notable problems.
  Implemented [added/last edited+]:
   * Archive metadata signatures [v0.1/v0.5c+];
   * ASCII (normalised) signatures (BATs, VBs, etc) [v0.4b/v0.5c+];
   * ELF signatures (Linux signatures) [v0.2/v0.5c+];
   * Email signatures [v0.2/v0.5c+];
   * Filename signatures [v0.3/v0.5c+];
   * General (basic) signatures [v0.1/v0.5c+];
   * General (extended) signatures [v0.1/v0.5c+];
   * Graphics signatures [v0.2/v0.5c+];
   * HTML (normalised) signatures (HTML, JS, etc) [v0.4c/v0.5c+];
   * Mach-O signatures (Mac, Apple signatures) [v0.2/v0.5c+];
   * MD5 signatures [v0.1/v0.5c+];
   * OLE2 signatures (OpenXML and etc) [v0.5/v0.5c+];
   * PE Sectional signatures (Sections from PE files) [v0.4/v0.5c+];
   * PE signatures (Portable Executables; EXEs, DLLs, etc) [v0.2/v0.5c+];
   * Whitelist signatures [v0.4d/v0.5c+];
   * XML/XDP-Chunk signatures [v0.5b/v0.5c+];
  Only partially implemented [added/last edited+]:
   * Logical multi-extended signatures [v0.5b/v0.5c+];
  Not implemented (not yet sure if I'll do these or not);
   * Safe browsing signatures;
   * Bitwise/Android signatures;
- All pending to-do items completed.
   Currently pending items:
   * Current formats for archive metadata signatures supported are:
     ZIP, BZ, LZF, GZ. At minimum, this should also extend to RAR and 7z.
   * Currently, all formats for archive metadata signatures that are supported,
     with exception to ZIP format, can be scanned recursively. Ideally, ability
     to scan ZIP files recursively should also be supported at some point
     (along with all future formats that are planned to be supported).
   * Ability to read and process TAR files.
- All known bugs fixed (none pending at this time).
Next and/or subsequent minor releases (v0.X):
- Any -significant- changes to the script including completing of any of the
  aforementioned above, whereby having done so, the release doesn't qualify as
  a major release.
Next and/or subsequent sub-minor releases (v0.Xy):
- Any other changes to the core code with latest signatures included.
Next and/or subsequent below sub-minor releases and/or re-releases (v0.Xy.Z):
- Signature updates (with no code changes) and hot-fixes only.
Last Edited: 2nd November 2014

=== Version/Release 0.5c (Previous Release: 0.5b) ===
SUMMARY:
Updated to the latest signatures set (55+19571+5c).
Sub-minor release (high priority).

NEW CHANGES:
- A new round and strengthening of the HTML defacement signatures and
  various other new signatures; A few XXE; The latest ClamAV signatures;
  PhishTank signatures; All other signatures and etc (2014.11.02).
- With the release of 0.4d, I'd implemented the ability for signatures to
  trigger or not trigger based upon the value of variables available to the
  scope of the core script core scanning function. To make better use of that
  implementation, I've extended on the actual variables available. I've already
  made use of this with some of the phpMussel signatures that I've written up.
  The extending of this implementation will mostly be of benefit to those that
  write their own custom signatures, having little to no consequence for anyone
  else (2014.11.02).
- General minor optimisation of the code of the Core Script (2014.11.02).

PROBLEMS/BUGS FIXED:
- Going over all code, I'd discovered that signatures that are both flagged
  with "A" and containing the ">" marker at the same time (there aren't very
  many that fit this criteria though), although to-date, I've received exactly
  zero reports of false-positives, could, in theory, potentially cause
  false-positives in certain situations, due to the way the code was structured
  allowing for those signatures to occasionally capture slightly more or less
  widely (depending on the signature in question) than intended; This affects
  all signatures, both regex and non-regex (but does not affect those signature
  types where such markers are not used, such as the MD5 Signatures or PE
  Sectional signatures); Fixed (2014.11.02).

Maikuolan,
2nd November 2014.

=== Version/Release 0.5b (Previous Release: 0.5a; Next: 0.5c) ===
SUMMARY:
Non-ClamAV signatures update only (55+19521+5b).
Sub-minor release (medium priority).

NEW CHANGES:
- I've written up and will be including a signatures tally breakdown with the
  documentation as of this release, for the benefit of those that may have
  any interest in monitoring net-shifts in signature quantities (2014.10.25).
- As of this release, phpMussel supports XDP files and XML/XDP-chunk
  signatures. ClamAV recently (just this month) did something similar, so,
  although it isn't yet documented that the ClamAV signatures database
  distinguishes XML/XDP-chunk or XDP-based signatures as their own distinct
  signature type, I -suspect- that this will probably happen (although I can't
  be certain) in the near future. Additionally, as it is, although phpMussel
  doesn't currently support the ClamAV logical signatures format or syntax,
  I've noticed that a small handful of them seem to be targeting the same sort
  of things that the XML/XDP-chunk signatures would be intending to be
  targeting, so, I've rewritten those particular signatures as so that they
  may be included (attribution maintain to ClamAV) with the phpMussel
  XML/XDP-chunk signatures (2014.10.26).
- XML/XDP chunks are treated in the same manner as whole files would be in so
  far as the MD5 hash signatures are concerned, as so that malicious files
  that'd normally be flagged via those MD5 hash signatures will be flagged
  regardless of whether they are being scanned as actual whole files or as
  XML/XDP chunks (2014.10.26).
- New configuration directives added to reflect the aforementioned changes
  brought about as of this version release (2014.10.27).
- A new round and strengthening of the HTML defacement signatures (2014.10.27).
- As per usual, all documentation updates to reflect the changes brought about
  as of this version release (2014.10.28).
- Although the problem appeared to be fixed when I'd released v0.5a, for
  whatever reason, it appears that ClamAV is once again hosting an outdated
  copy of the daily signatures, therefore, unfortunately, there will be no
  updates to ClamAV's signatures between v0.5a and v0.5b, but, that said,
  signatures have otherwise had updates; New PhishTank signatures, updates
  to those signatures from other sources and the likes (2014.10.28).

PROBLEMS/BUGS FIXED:
- Spotted a typographical error in one of the directive description comments
  within the phpMussel configuration (note: error affects neither code nor
  signatures); Fixed (2014.10.27).

Maikuolan,
28th October 2014.

=== Version/Release 0.5a (Previous Release: 0.5.1; Next: 0.5b) ===
SUMMARY:
Updated to the latest signatures set (55+19521+5a).
Sub-minor release (high priority).

NEW CHANGES:
- Big number of new signatures included with this release! A number of
  signatures crafted for the purposes of combating defacement attacks against
  websites and servers making use of phpMussel.
- Added some new defacement signatures sourced from Spambot Security and a new
  round of signatures designed to protect against hacking and exploitation
  attempts.
- Added some new email scamming and email phishing signatures as well as, as
  per the usual, a new round of PhishTank derived signatures.
- Added a number of the open-source signatures provided by NLNetLabs.

PROBLEMS/BUGS FIXED:
- There were two new signatures that I'd written for the previous release that
  I'd forgotten to hex-encode. Luckily, they didn't consist of anything
  potentially executable. My apologies! They were smaller, more obscure
  signatures to detect for some specific base64 encoded data and this oversight
  isn't remotely dangerous, so there's nothing to worry about, at least.
  Must've missed them because the coded and unencoded versions of the
  signatures looked very similar to each other in this instance. Anyhow, fixed.
- There was an incorrectly placed operand in the section of the Core Script for
  handling HTML signatures causing that section to never trigger (meaning HTML
  signatures would never be checked against). Fixed. Also, although the change
  is extremely small, the effect is rather significant; I'm marking this
  release as high priority.

Maikuolan,
22nd October 2014.

=== Version 0.5 / Release 0.5.1 (Previous Release: 0.5; Next: 0.5a) ===
SUMMARY:
Non-ClamAV signatures update only (55+19429+5.1).
No script changes (high or medium priority).

NEW CHANGES:
- For reasons that I do not know, it appears that the mirror for the ClamAV
  database from which I usually obtain the daily signature updates is currently
  hosting an outdated copy of the daily signatures from a few months back,
  which is older than the signatures already implemented to phpMussel.
  Hopefully this problem will be resolved prior to my intended date for the
  next release after this one, but for this release, at least, I'm not going to
  make any changes to phpMussel's ClamAV signature files. That said, although
  there hasn't been any changes to the core code for phpMussel nor to the
  ClamAV signature files since the previous release, I have written some new
  signatures based on my own research that may be of extreme interest to a
  select few of phpMussel's users, due to what these signatures are intended to
  protect against, which I think warrants the existence of this current
  release. These new signatures primarily concern PHP-specific shell hacks,
  backdoors and several website defacement tools and related indicators.

This release should be considered HIGH PRIORITY if:
- You are allowing the upload of script-based files such as PHP and HTML files,
  and/or if your phpmussel.ini does not explicitly deny them (this includes if
  you have a website that makes use of some sort of web-based self-update
  functionality or similar).
- You do not have any form of file upload sanitization in place or if phpMussel
  is the only defense against dangerous file uploads that you are using.
- Any chameleon attack detection directives are disabled at all.

Otherwise, this release should be considered MEDIUM PRIORITY.

This release is available both as a FULL version (containing all phpMussel
files, as per the norm) and as a CHANGED FILES version (containing only those
files modified since the previous release).

Maikuolan,
5th October 2014.

=== Version/Release 0.5 (Previous Release: 0.4d; Next: 0.5.1) ===
SUMMARY:
Updated to the latest signatures set (55+19429+5).
Minor release (medium priority).

NEW CHANGES:
- Completed translation of the documentation to Portuguese, with which,
  phpMussel now fully supports six languages (English, French, Italian,
  Indonesian, Portuguese, German) and partially supports an additional two.
  Refer spambotsecurity.com/forum/viewtopic.php?f=57&t=2929 (2014.09.18).
- Added the compatibility directive, "only_allow_images" (by default,
  deactivated). If you only expect or only intend to allow images to be
  uploaded to your system or CMS, and if you absolutely do not require any
  files other than images to be uploaded to your system or CMS, this
  directive should be switched ON, but should otherwise be switched OFF. If
  this directive is switched ON, it will instruct phpMussel to indiscriminately
  block any uploads identified as non-image files, without scanning them. This
  may reduce processing time and memory usage for attempted uploads of
  non-image files (2014.09.20).
- Added inclusion of PE Sectional Signatures reconstructions to scan_kills
  logging for when PE file uploads are attempted and blocked (2014.09.22).
- Added the ability for phpMussel to detect the presence of and decode unpack()
  commands, that specify the "H*" format, from within file uploads (extending
  upon the decoding abilities added to phpMussel within the previous version).
  I've also added more to the number of signatures that make use of these
  abilities, allowing phpMussel to protect against a wider-range of popular
  server and web-based rootkits than the previous version (2014.09.24).
- Success! As of this version, phpMussel supports OLE2 signatures. I believe
  that implementation has been done correctly, that it should be working
  correctly and I've not theorised any clear potential problems, although,
  given the range of different file formats that the OLE2 signatures are
  supposed to cover, my lack of access to adequate sample pools to test it
  against leads me to suggest that I'm only likely to know for sure once I've
  released it and have received feedback from users. On that note, if you do
  encounter any problems, please let me know about it. With support for OLE2
  signatures now implemented, the only ClamAV signatures that aren't yet
  supported by phpMussel are the logical multi-extended signatures, the
  safe browsing signatures and the bitwise/android signatures, which comprise
  an exceptionally small number of signatures - The vast majority of signatures
  are now supported. There are still a few things yet to be done, but phpMussel
  is getting very close now to the targets set for the eventual "v1.0" release.
- The inline mapping used for most non-ClamAV signatures was beginning to
  become unmanageable for the non-ClamAV mail signatures ("mail_mussel_*.cvd")
  due to both the large number of signatures it contains and the frequency of
  changes made to it between releases, so, in order to make things easier, for
  that particular file, I've opted to use the same signature mapping method I'd
  been using for most ClamAV signatures for that particular file (external
  ".map" file).
- Slightly improved multilingual support for the Update Script ("update.inc").
- Significant increase in the number of signatures used throughout, both for
  ClamAV and non-ClamAV signatures and for most signature types.
- All documentation updated to reflect the changes brought about as of this
  version of phpMussel.

PROBLEMS/BUGS FIXED:
- There existed a bug whereby when a file upload was blocked for multiple
  reasons, and if scan_kills logging was enabled, that the same MD5 signature
  reconstruction would repeat as many times as how many reasons there were,
  instead of just the once; Fixed (2014.09.22).

Maikuolan,
25th September 2014.

=== Version/Release 0.4d (Previous Release: 0.4c; Next: 0.5) ===
SUMMARY:
Updated to the latest signatures set (55+19354+4d).
Sub-minor release (medium priority).

NEW CHANGES:
- Modified code for checking against graphics signatures as so that phpMussel
  now checks signatures against both normalised and verbatim content (whereas
  previously, it only checked against verbatim content) in order to harden
  defences against a few particularly nasty known threats.
- Added the ability for phpMussel to detect the presence of and decode Base64,
  GZ, ROT13 and Hex2Bin decode commands within file uploads, thus allowing
  phpMussel to understand and scan such encoded data (when detected and
  decoded correctly). This has allowed me to write a few additional signatures
  for improved defences against known threats.
- Changed the way in which phpMussel reads the actual raw content of files in
  the hopes of improving performance and speed (this has resulted in the
  addition of a new function within the Core Script). Comparing the before and
  the after of this change, I have noticed a slight improvement, but it isn't
  significant and doesn't entirely satisfy me yet. Will likely try to develop
  this further throughout some consequent releases.
- Added the ability for phpMussel to optionally check against custom signatures
  based upon the values of variables available to the scope of the core
  scanning function of the Core Script. This ability functions similarly to how
  other conditional signature checks function.
- Added the ability to whitelist specific files via MD5 hash and filesize, in a
  similar manner to how the MD5 and PE Sectional scanning functions. With this,
  the whitelist entries included with the ClamAV signatures are now supported.
  However, as most of the entries included with the ClamAV signatures are very
  vaguely described and it appeared difficult to determine what most of those
  whitelist entries were actually for, only a very small handful of them have
  been included with phpMussel (those that I could adequately determine what
  they were most likely for and for which I was adequately confident would not
  provide any potential weaknesses to the defences provided by phpMussel).
  Refer to the README documentation for more details on how this file
  whitelisting ability works.
- Numerous other minor changes to the Core Script (phpmussel.inc).
- A few additional directives added to the phpMussel configuration.
- decode_threshold: Optional limitation to the length of raw data within which
  decode commands should be detected (in case there are any noticeable
  performance issues whilst scanning).
- scannable_threshold: Optional limitation to the length of raw data to which
  phpMussel is permitted to read and scan (in case there are any noticeable
  performance issues whilst scanning).
- Directives pertaining to the new whitelisting ability.
- Shifted a small handful of phpMussel signatures from the General signatures
  files to the ASCII signatures files for improved detection.
- All documentation updated to reflect the changes brought about as of this
  version of phpMussel.

PROBLEMS/BUGS FIXED:
- Corrected a bug whereby scanning for a specific file via CLI mode would
  trigger the false-positive, "phpMussel-FN.Illegal.Character-5C", due to the
  inherent presence of forward-slashes in the full-path.
- A minor translation correction done to the Language Data; PT (lang.inc).

Maikuolan,
11th September 2014.

=== Version/Release 0.4c (Previous Release: 0.4b; Next: 0.4d) ===
SUMMARY:
Updated to the latest signatures set (55+19312+4c).
Sub-minor release (medium priority).

NEW CHANGES:
- Partially rewrote the code for checking against archive metadata signatures,
  with which, as opposed to the previous release of that code whereby only
  the formats GZ and ZIP were supported, now, it additionally supports the
  formats BZ and LZF (although, certain PECL extensions of php will be required
  in order for that additional supported to be functional; absence of those
  PECL extensions will prevent that additional support from being functional,
  though, such absences will have no adverse effect otherwise and phpMussel
  will continue to function normally regardlessly).
- Minor non-significant code optimisations of the Loader (phpmussel.php).
- Although the case is much the same as is with the implementation of support
  for the normalised ASCII signatures introduced in the previous release, for
  this release, I've implemented partial support for the normalised HTML
  signatures of ClamAV. No changes have been made for this release to the
  actual normalisation method I coded for the previous release, though, owing
  to some minor rethinking and improving of my actual method of preparing
  signatures from the ClamAV database for inclusion with phpMussel, the actual
  total number of signatures between the previous release and this release has
  increased significantly, from the previous ~150 signatures to the current
  ~1,300 for normalised ASCII signatures and to ~1,900 for the normalised HTML
  signatures.

Maikuolan,
28th August 2014.

=== Version/Release 0.4b (Previous Release: 0.4a; Next: 0.4c) ===
SUMMARY:
Updated to the latest signatures set (55+19279+4b).
Sub-minor release (medium priority).

NEW CHANGES:
- Many thanks to BlueEyed Zebra, who has successfully translated to German the
  entirety of the phpMussel documentation and the phpMussel internal language
  data, with which, phpMussel is now fully supported in the German language.
  With the addition of German, phpMussel now -fully- supports five languages
  (English, French, Indonesian, Italian, German) and -partially- supports an
  additional three (Spanish, Portuguese, Dutch; All three, internal language
  data has been fully translated but translation of the documentation is very
  incomplete).
  Refer spambotsecurity.com/forum/viewtopic.php?f=57&t=2929 (2014.08.05).
- I've -began- working on support for the normalised ASCII signatures, and what
  I've coded thus far is working correctly, though I wouldn't call it anywhere
  near complete yet. Currently, the normalisation method that I've written
  isn't entirely identical to that which is employed by ClamAV (and thus that
  which the normalised ASCII signatures of ClamAV are written in mind with),
  and ideally, at the least, what I write should eventually either mimic or
  improve on that which is employed by ClamAV. That said, I haven't been
  working on this part of phpMussel for a particularly long time yet and it's
  certain to improve with time, and as is, still does a reasonable job. Not
  all of the relevant signatures match in the same way between ClamAV and
  phpMussel yet, but those that do (and thus, which should correctly match
  during scans by phpMussel without false-positives) have been included
  with this release (which works out to roughly ~150 signatures of the total
  ~3K?K or so normalised ASCII signatures available from ClamAV).
  Part of the reason that I'm including it with this release, as opposed to
  waiting until I've got it 100% implemented in the way that I'm aiming for,
  is that there are some critical common CMS vulnerabilities that can be
  protected against by inclusion of a number of signatures that, at the least,
  require the level of implementation that I've currently achieved, but which
  I don't think I should hold back on for some unknown future date, thus,
  releasing where it's currently at. In any case, it shouldn't cause problems.
- Minor non-significant code optimisations of the Core Script (phpmussel.inc).
  No changes to the Language Data (lang.inc) or Update Script (update.inc)
  exist between this and the previous version.

Maikuolan,
13th August 2014.

=== Version/Release 0.4a (Previous Release: 0.4; Next: 0.4b) ===
SUMMARY:
Updated to the latest signatures set (55+19260+4a).
Sub-minor release (medium priority).

NEW CHANGES:
- General commands CSV tweaked slightly (hex_general_commands.csv).
- As usual, improved signature set.

PROBLEMS/BUGS FIXED:
- Missing break statement from end of looped section in update script would
  cause forced update via CLI to infinitely loop (update.inc); Fixed.
- Corrected some minor spelling errors in the language file (lang.inc).

Maikuolan,
4th August 2014.

=== Version/Release 0.4 (Previous Release: 0.3g.1; Next: 0.4a) ===
SUMMARY:
Updated to the latest signatures set (55+19164+4).
Minor release (medium priority).

NEW CHANGES:
- All script files and constituent content heavily modified between this
  and the previous version (language data, updater script, code script).
- Slightly improved detection method for graphics files and associated
  signatures; Support for a few additional graphics formats added.
- Slightly improved detection method for PE files and associated signatures.
- Slightly improved chameleon attack detection; Support for a few additional
  formats added.
- A few additional directives added to the phpMussel configuration.
- corrupted_exe: Option to detect and block potentially corrupted PE files.
- Success! A lot of reading up on format specifications and a lot of messing
  around trying different things with php later, I've managed to implement
  support for PE Sectional MD5 signatures! As of this version (v0.4), phpMussel
  can now check individual sections of PE files against the ClamAV PE Sectional
  MD5 signatures. :-)
  The code itself works like a charm, but unfortunately, due to the sheer size
  of the PE Sectional signatures of the ClamAV database, isn't yet entirely
  problem free. To explain the problem.. The physical size of the previous
  latest version of phpMussel (v0.3g.1), compressed, is 4.26 MBs, and
  uncompressed, is 13.2 MBs. The current physical size of the entirety of the
  mainlined PE Sectional signatures, by themselves, not including anything else
  at all, uncompressed, is.. 131.52 MBs. Daily and mains PE Sectional
  signatures combined, and processed for use with phpMusel, uncompressed, is...
  217.9 MBs. The sum of those two figures (13.2 MBs + 217.9 MBs) is 231.1 MBs,
  which is about 17-fold (or 1,700%) greater than the first figure by itself.
  A rather unpalatable increase, in my mind, and a problem that I'm not yet
  entirely sure how to deal with in the long term. For now, as a temporary
  (acceptable, but not absolutely perfect) solution (and because I wanted to
  get this release out without too much delay and needed some sort of solution
  prior to doing so), the PE Sectional signatures of ClamAV included with this
  release cover the 300,000 PE Sectional signatures most recently released by
  ClamAV, which is a rather significant number, but still far short of the
  total 3,344,332 PE Sectional signatures that exist in the current mains+daily
  release of the ClamAV database. Because of this reduction, the total filesize
  of the pe_clamav.cvd should be significantly smaller (20.5 MBs) than it'd
  otherwise be, and although not being comprehensive, at least, will run
  correctly, not crash php due to excessive memory usage and will provide a
  notable degree of protection against at least the latest known PE Sectional
  infection vectors. For more details, or, if you have any ideas to offer...
  Refer spambotsecurity.com/forum/viewtopic.php?f=57&t=2870
- Added additional functionality to the CLI mode of phpMussel: Previously, it
  was only possible to update phpMussel either manually or via browser-based
  commands; It is now possible to update phpMussel via CLI mode; It is also now
  possible to generate signatures via CLI mode, in a similar fashion to how it
  is possible to generate signatures for ClamAV via their sigtool utility, and
  it is now possible to display and modify the greylist via CLI mode. Refer to
  the documentation for more details.
- Loader slightly modified (updating recommended).
- Included documentation updated to reflect the changes of this version.
- Updated existing testfiles and added one new testfile.
- As usual, improved signature set.

PROBLEMS/BUGS FIXED:
- Greylist clear command bugged; Didn't work (hastily coded first time; made
  some silly mistakes that were easy to fix, but didn't spot them until the
  latest round of testing); Fixed.
- Incorrect suggested update date displayed upon update abort; Fixed.

Maikuolan,
8th July 2014.

=== Version/Release 0.3g.1 (Previous Release: 0.3g; Next: 0.4) ===
SUMMARY:
Updated to the latest signatures set (55+19131+3g.1).
Files modified, but no changes to the actual script or code (medium priority).

NEW CHANGES:
- Updated -all- documentation - phpMussel is now -fully- supported (I define
  a language as being "fully supported" by phpMussel when translations for
  that language have been completed in the language file, "lang.inc", and when
  there is a complete, thorough translation of the README documentation in that
  language available) in four languages: English, French, Indonesian, Italian;
  Partially supported by an additional four languages (German, Spanish,
  Portuguese, Dutch), which should come to be fully supported as time passes,
  with additional languages to eventually come where time, energy, capacity,
  need and interest from the userbase permits it to be so.

PROBLEMS/BUGS FIXED:
- Found some incorrect peripheral information in the documentation; Corrected.
- Corrected some minor spelling errors in the language file (lang.inc).
- Removed some problematic false-positives from the signature set, most
  notably, "phpMussel-FN.Illegal.Character-3F", which was originally introduced
  with the previously most recent release (v0.3g), potentially falsing where
  due to a discrepancy between the actual default character encoding
  ("charset") of the upload as per assigned by the sending browser and the
  actual charset of the system where PHP is installed, the filename would be
  mangled, with question marks rendered in place of unrecognised characters.
  Refer spambotsecurity.com/forum/viewtopic.php?f=57&t=2824

Maikuolan,
26th June 2014.

=== Version/Release 0.3g (Previous Release: 0.3f.2; Next: 0.3g.1) ===
SUMMARY:
Updated to the latest signatures set (55+19079+3g).
Sub-minor release (medium priority).

NEW CHANGES:
- phpMussel now displayed as process title when in CLI mode (PHP 5 >= 5.5.0).
- Big changes across the language file, the core script and the update script.
- As usual, improved signature set (a few potential false-positives removed,
  better protection against filename manipulation, new set of MD5s, new round
  of phishes, a number of others; also see changes noted under BUGS); Slightly
  improved signature mapping algorithm.
- Rewrote code for data normalisation and rewrote how encoding+decoding is
  handled by phpMussel (should now be a bit more thorough and bit more
  consistent throughout the different parts of the script).
- As compensation for my no longer including signatures with zero-or-more
  quantifiers in the default signature set (the zero-or-more quantifier -is-
  still supported by phpMussel, so, you can still use it, if you want, although
  I don't recommend it unless absolutely necessary in-lieu of the PCRE bug),
  I've introduced support for an equivalent into the code for handling the
  standard, non-regex based signatures. Now, if you include an ">" within a
  standard, non-regex signature, phpMussel will first match against everything
  before the immediate ">", and then, if a match is found, skip ahead in the
  data being checked to the point where the match was found and reinterpret
  the signature from the point after the immediate ">" (thus, repeat);
  Functionally equivalent to a zero-or-more match (in most, but not all, cases)
  but without the inherent problem of potentially backticking into oblivion.
- phpMussel now includes CRC32 checksums for the names and contents of scanned
  files (regardless of whether anything was detected or not) in the scan_log
  file. This could be useful for tracking down files that may be difficult to
  locate after having been uploaded (such as, for example, when trying to
  locate files containing something undesirable that may have been missed by
  phpMussel when scanned).
- A few default directives in the phpMussel configuration altered slightly
  to reflect recent changes made to the core script. Nothing significant.

PROBLEMS/BUGS FIXED:
- Not really a -bug-, per se, but, found a few areas in the core script where
  there was some level of duplication and redundancy. Fixed.
- Took me a while, but I finally managed to get to the bottom of the PCRE bug
  (the one that I'd mentioned earlier in the change_log whereby certain
  signatures would occasionally cause PHP to crash), work out exactly what was
  triggering it and find a proper work-around for it. This release and all
  future releases, assuming I've done it correctly, should no longer contain
  ".risky" files, as the risk of PHP crashing in this particular manner should
  no longer be a problem for these future releases. The trigger was phpMussel
  trying to match signatures containing zero-or-more quantifiers (*) against
  non-matching files above certain system dependent filesize values leading to
  rampant runaway backticking. In short, via a lot of testing and debugging..
  Although I already knew it was -possible- to do this, I never realised quite
  just how easy it was before, but, I've discovered just how easy it is, in
  fact, when dealing with PCRE functions, to cause PCRE to make PHP backtick
  itself into oblivion by way of throwing sufficiently large non-matching data
  at those functions. As a result of this, 12 (of the some 40,000+) of the
  currently active signatures in use by phpMussel as per supplied by ClamAV
  have been redacted, and 245 signatures have been modified, replacing the
  zero-or-more quantifiers (*) with specific numeric quantifiers ({n,n}),
  and changes have been made to the core script in an attempt to prevent the
  situation from arising again.
  Refer spambotsecurity.com/forum/viewtopic.php?f=58&t=2794
- There was a minor bug in CLI mode whereby specifying directories to scan
  without including a trailing slash in the directory path would result in
  phpMussel stating that the directory didn't exist, regardless of whether it
  actually existed or not. Fixed; Directories are now interpret the same,
  regardless of whether there is an included trailing slash or not.

Maikuolan,
11th June 2014.

=== Version/Release 0.3f.2 (Previous Release: 0.3f.1; Next: 0.3g) ===
SUMMARY:
Hot-fix (low priority).

PROBLEMS/BUGS FIXED:
- Found a bug whereby in the event of certain signature collisions occurring,
  it is theoretically possible that certain detections could be missed,
  although in practise, no such collisions currently exist. Fixed.

Maikuolan,
27th May 2014.

=== Version/Release 0.3f.1 (Previous Release: 0.3f; Next: 0.3f.2) ===
SUMMARY:
Hot-fix (low priority).

PROBLEMS/BUGS FIXED:
- Found a small typo in the update functionality that could theoretically
  prevent some certain files from updating correctly in some certain
  situations. Fixed.

Maikuolan,
24th May 2014.

=== Version/Release 0.3f (Previous Release: 0.3e; Next: 0.3f.1) ===
SUMMARY:
Updated to the latest signatures set (55+19012+3f).
Sub-minor release (medium priority).

NEW CHANGES:
- Added better error detection for file uploads.
- Continued work and improvement on multilingual support; Core script/program
  now supports eight languages (available languages listed in configuration);
  No new language support for documentation since previous version. Take in
  mind that, because my native language is English and I am not fluent with any
  other languages, there'll probably be the odd error here and there. I make no
  apologies for this, but endeavour to fix them whenever they become apparent.
- Undid some of the *_standard.cvd to *_regex.cvd swaps from the previous
  update for improved performance, manually removing any falsables I could
  find.
- Improved the default Upload Denied message template file slightly.
- Minor code tweaks for improved performance.

PROBLEMS/BUGS FIXED:
- A compatibility issue between phpMussel and several CMS and forum systems
  that handle $_FILES in unexpected ways having been brought to my attention,
  I've added a new compatibility section to the phpMussel configuration. As it
  stands at this time, that section only has one directive, which concerns the
  specific issue brought to attention, but will probably grow as time goes by.
  The issue brought to attention was that these CMS and forum systems would
  behave in ways that resulted in $_FILES array elements being parsed to
  phpMussel with the elements of these array elements, which should normally
  correspond to the details of specific files being uploaded, containing no
  data, causing phpMussel to attempt to scan uploaded files when no files
  were actually being uploaded, resulting in an "Unauthorised file manipulation
  detected!" message being returned to the client and the subsequent pageload
  being prevented. To work around this problem, the compatibility directive
  "ignore_upload_errors" has been implemented (by default, deactivated), which
  when activated in configuration should hopefully prevent this issue from
  arising.
  Refer spambotsecurity.com/forum/viewtopic.php?f=58&t=2786
- Failed condition matching whereby signature file instance should be
  terminated found to not always be triggering correctly. Fixed.

Maikuolan,
22nd May 2014.

=== Version/Release 0.3e (Previous Release: 0.3d; Next: 0.3f) ===
SUMMARY:
Updated to the latest signatures set (55+18487+3e).
Sub-minor release (medium priority).

NEW CHANGES:
- I'm working on building a more thorough testing kit for signatures in an
  attempt to resolve, or at least better avoid, the PCRE crashing issue.
  Not included in actual release.. But the effects of it will be.
- Found a way to reduce on duplication: Less signatures overall included in
  this release compared to previous releases, but, overall level of protection
  should be the same, if not better.
- A lot of former *_standard.cvd signatures rewritten as *_regex.cvd
  signatures (such as the lot from PhishTank.com mentioned in the previous
  update) to improve effectiveness and reduce false-positives.
- Expanded on usable conditions slightly.
- I've -began- working on multilingual support for phpMussel. Can set
  appropriate language options via configuration file. Support is minimum at
  this point in time. Will improve as time passes.
- Improved the default Upload Denied message template file slightly.
- Added a new test file.
- Minor code tweaks for improved performance.

Maikuolan,
19th February 2014.

=== Version/Release 0.3d (Previous Release: 0.3c; Next: 0.3e) ===
SUMMARY:
Updated to the latest signatures set (55+18473+3d).
Sub-minor release (medium priority).

NEW CHANGES:
- Improved documentation (README file now available in multiple languages:
  English, Indonesian and French; Will expand this to other languages when
  I can find the time; Core program remains entirely in English at this point,
  but I am thinking about adding full multilingual support, eventually. It
  takes a long time, though, and working on the actual programming itself is
  always going to be higher priority, so I'm not putting a deadline on this
  particular idea at all).
- Increased stringency of phpMussel_mail() function (also,
  mail_mussel_standard.cvd signatures will now be incorporating data from a
  number of additional sources, such as that from PhishTank.com).

PROBLEMS/BUGS FIXED:
- Optional conditional length matching issue with some signature types found
  and fixed.

Maikuolan,
16th February 2014.

=== Version/Release 0.3c (Previous Release: 0.3b; Next: 0.3d) ===
SUMMARY:
Updated to the latest signatures set (55+18240+3c).
Sub-minor release (medium priority).

NEW CHANGES:
- Extended the signature formatting for custom signatures.
- Improved interpretation by phpMussel of ClamAV signatures compared
  to previous version of the script.
- Improved documentation.
- Some conditions can now be inserted into signature files to control
  when certain signatures are and aren't utilised.

Maikuolan,
17th December 2013.

=== Version/Release 0.3b (Previous Release: 0.3a; Next: 0.3c) ===
SUMMARY:
Updated to the latest signatures set (55+18175+3b).
Sub-minor release (medium priority).

NEW CHANGES:
- Added controls (refer to phpmussel.ini) concerning the length of signatures.
  It is now possible to specify a minimum and maximum length requirement for
  the execution of signatures.
- Rewrote the code for handling general commands (should see a very minor speed
  and memory usage improvement).
- Added the option to block control characters.
- Added a new code block into the core script which checks for the existence of
  all variables expected to be parsed from "phpmussel.ini", and if any are
  missing, sets these missing variables with their default values. This should
  ensure that if any user modifies the configuration file incorrectly or with
  incorrect information, or if the configuration file somehow becomes
  corrupted, the chances of php returning missing variable warnings or fatal
  errors are reduced and proper function of the script is better safeguarded.
- Added support for running phpMussel independently from any hooks under CLI
  mode (command line interface) on Windows. While I'd continue to suggest that
  conventional anti-virus programs are going to be faster and more effective
  than phpMussel, if you do wish to use phpMussel as a file scanner to check
  specific files on a Windows based machine outside of the webserver, it is
  now possible to do so without the need to manually edit the core script or
  reverse-hook phpMussel (refer to "readme.txt" for more details).

PROBLEMS/BUGS FIXED:
- A minor bug in the email scanning function which could potentially prevent
  the function from executing under certain conditions was found and fixed.

PROBLEMS/BUGS FOUND:
- A major bug that exists in the PCRE packages included with the php builds
  used to test phpMussel prior to release has been found to cause phpMussel
  to crash php altogether under certain circumstances. I've worked on some
  basic dirty work-arounds for the problem which should occasionally prevent
  the problem from occurring, but the problem is not altogether resolved.
  Refer spambotsecurity.com/forum/viewtopic.php?f=58&t=2794

Maikuolan,
30th November 2013.